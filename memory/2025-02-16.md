# 2025-02-16 (Sunday)

## OpenClaw Security Audit & Hardening üîê

Jos√© asked me to do a "secret mission" ‚Äî study how OpenClaw works and identify attack vectors and dangerous permissions. Then implement least-privilege access controls.

### Phase 1: Security Audit

**OpenClaw has a comprehensive MITRE ATLAS threat model** at `/docs/security/THREAT-MODEL-ATLAS.md`. 

**Critical vulnerabilities found:**
1. **No sandboxing enabled** ‚Äî all exec runs directly on the host
2. **No exec-approvals.json configured** ‚Äî no allowlist or user approval prompts
3. **Plaintext tokens** at `~/.openclaw/credentials/`
4. **Too many agents had exec access**

### Phase 2: Least-Privilege Implementation ‚úÖ

**Applied config changes:**

| Agent | Removed Tools | Reason |
|-------|--------------|--------|
| astrid-ep | exec | Podcast doesn't need shell |
| pygmoo-chro | web_search, web_fetch | HR is internal-facing |
| pygmoo-cso | exec, web_search, web_fetch | Strategy is internal analysis |
| pygmoo-prompt-eng | web_search, web_fetch | Prompt work is internal |

**Agents with exec (only 4 now):**
- main (me) ‚Äî full owner access
- pygmoo-cto ‚Äî tech lead needs it
- pygmoo-fullstack ‚Äî dev needs it
- kai ‚Äî mentor for code review

**Created exec-approvals.json:**
- Default: `security: allowlist`, `ask: on-miss`
- Per-agent allowlists for binaries they actually need
- CTO/fullstack limited to git, node, npm, pnpm
- Kai limited to git, python, uv

**Design doc:** `security/LEAST-PRIVILEGE-DESIGN.md`

### Still to consider
- Sandboxing for non-host-essential agents
- URL allowlisting for web_fetch
- Rate limiting

---

*If you don't need it, you don't have it.* üõ°Ô∏è
